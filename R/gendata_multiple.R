###################
# Data generation #
# (Size Analysis) #
###################
set.seed(2797542)
K <- 70
nsim <- 10000
beta_true <- matrix(c(0.1275723, 0.2171228, 0.3081110, 0.3511947, 0.7959736, 0.4038531, 0.4795192, 0.2260417,
1.3584910, 2.3825286, 1.0019399, 0.4052773, 0.5444945, 0.5236327, 0.5309396, 0.5486614,
0.5623856, 0.3765636, 0.2266925, 0.1756061, 0.3290557, 0.5376993, 0.5953601, 0.5525292,
0.3357988, 0.3952969, 0.4207817, 0.4348561, 0.4110409, 0.1835819, 0.1883897, 0.1296391,
0.3508947, 0.6147458, 0.4909258, 0.4128457, 0.4515024, 0.4132818, 0.4543722, 0.4986570,
0.5301654, 0.2680528, 0.2519400, 0.1456691, 0.3242887, 0.5284132, 0.4504773, 0.4767986,
0.3997492, 0.4771224, 0.4647772, 0.4726600, 0.4750175, 0.3284144, 0.3066620, 0.1519053,
0.2802797, 0.5036309, 0.5822183, 0.5149771, 0.3734794, 0.3948873, 0.4032494, 0.4100586,
0.4468242, 0.3222923, 0.2761854, 0.1615315, 0.2563319, 0.3772574, 0.4710287, 0.4229677,
0.5113622, 0.5536044, 0.5690038, 0.5317177, 0.5211124, 0.3035806, 0.2460477, 0.1647474,
0.3822736, 0.7932413, 0.5747804, 0.4934105, 0.4356089, 0.4714201, 0.5025385, 0.5424768,
0.5164568, 0.2821819, 0.2691165, 0.1674050, 0.3336717, 0.4937105, 0.5724915, 0.5419586,
0.3284741, 0.3489108, 0.4067004, 0.4288516, 0.4418429, 0.2710459, 0.1857509, 0.1125911,
0.2357910, 0.4080935, 0.3429750, 0.3315491, 0.4981028, 0.5216440, 0.5371516, 0.5714386,
0.5855195, 0.2975419, 0.3209480, 0.1844910, 0.3644227, 0.5707449, 0.6458457, 0.5532275,
0.4702482, 0.4405116, 0.4243047, 0.4706976, 0.4678369, 0.2386029, 0.1862869, 0.1308019,
0.3025070, 0.3494058, 0.4118278, 0.4623836, 0.3081094, 0.3732077, 0.3761074, 0.3706099,
0.3998539, 0.2552004, 0.2709500, 0.1817386, 0.2890607, 0.4550335, 0.4212473, 0.3677032,
0.3789227, 0.4096517, 0.4355518, 0.4409613, 0.4871740, 0.6400537, 0.3116382, 0.1779999,
0.3501122, 0.4719613, 0.3859132, 0.4214637, 0.4358486, 0.3962583, 0.4003125, 0.4391502,
0.5179681, 0.4936818, 0.2055493, 0.1351303, 0.2836813, 0.4292052, 0.4399500, 0.4683949,
0.4417972, 0.4205337, 0.4182235, 0.4422414, 0.5482904, 0.2342961, 0.2063070, 0.1437981,
0.3012337, 0.4449266, 0.3949865, 0.4174462, 0.4658631, 0.4756963, 0.5122125, 0.5618358,
0.5428506, 0.3997647, 0.3656613, 0.1756530, 0.3295819, 0.6965748, 0.5991151, 0.5033596,
0.5463636, 0.5232757, 0.5245752, 0.5595121, 0.5515097, 0.3108743, 0.2602779, 0.1569271,
0.2683762, 0.6010637, 0.5937545, 0.5448436, 0.5566080, 0.5404081, 0.5286979, 0.5132365,
0.5547322, 0.3187384, 0.1669004, 0.1265456, 0.3483649, 0.5721666, 0.5381855, 0.5880174,
0.5099147, 0.5316583, 0.5230508, 0.5365181, 0.5378713, 0.3925432, 0.2912928, 0.1671957,
0.3228216, 0.5209287, 0.5646782, 0.5488027, 0.3460908, 0.3664352, 0.3565424, 0.3967138,
0.4362319, 0.3720437, 0.2322005, 0.1547735, 0.3018471, 0.5537609, 0.4183475, 0.4257506,
0.3927374, 0.4110849, 0.4299553, 0.4630775, 0.5888526, 0.3187948, 0.3068038, 0.1812327,
0.3636568, 0.5833732, 0.5050208, 0.4633725, 0.3986953, 0.4210301, 0.4122330, 0.4304064,
0.4385551, 0.2772909, 0.3709811, 0.1771347, 0.3301942, 0.5403029, 0.5118093, 0.3937438,
0.4296906, 0.4212315, 0.4460896, 0.4450868, 0.4473610, 0.2419635, 0.2305823, 0.1491931,
0.2913239, 0.4081383, 0.4716768, 0.4646975, 0.4118083, 0.3757133, 0.3804427, 0.4171646,
0.4436916, 0.3368843, 0.1848066, 0.1428415, 0.2906296, 0.5067905, 0.4198099, 0.4012672,
0.3909191, 0.3753936, 0.3996358, 0.3965559, 0.4558737, 0.3331946, 0.2737851, 0.1804058,
0.3114853, 0.7225091, 0.5410612, 0.3777433, 0.3638129, 0.3654462, 0.3772129, 0.3806440,
0.3529674, 0.2183122, 0.1523978, 0.1206746, 0.2602506, 0.3388680, 0.3753706, 0.3726719,
0.5451569, 0.5379713, 0.5862367, 0.6165266, 0.6169164, 0.6343816, 0.2571071, 0.1410201,
0.3069147, 0.5191181, 0.5550714, 0.5290042, 0.4034582, 0.4669141, 0.4833851, 0.4904637,
0.4739323, 0.3427771, 0.2624738, 0.1466243, 0.3182946, 0.4251999, 0.6093804, 0.5459347,
0.4482511, 0.4999577, 0.5166653, 0.4985260, 0.4433156, 0.5695036, 0.2986641, 0.1652782,
0.2679887, 0.5435838, 0.5174679, 0.4978418, 0.3041193, 0.3488134, 0.3634898, 0.3872111,
0.3169256, 0.2600349, 0.2390257, 0.1697706, 0.2774305, 0.3514142, 0.4138466, 0.3989645,
0.5440294, 0.5460139, 0.5366055, 0.5364159, 0.4841379, 0.2922079, 0.2857683, 0.1509488,
0.3060899, 0.4291707, 0.5251736, 0.5792246, 0.3582144, 0.4472419, 0.4679336, 0.4959834,
0.4788454, 0.1562478, 0.4049201, 0.3146375, 0.3291046, 0.5487720, 0.5677986, 0.5341627,
0.4839384, 0.4882545, 0.4866299, 0.4784891, 0.4715546, 0.2558165, 0.1426956, 0.1103919,
0.2440325, 0.5374797, 0.5612712, 0.4971420, 0.4710010, 0.5039502, 0.5230138, 0.5117551,
0.6076788, 0.2395489, 0.1457969, 0.1112086, 0.2662448, 0.5002825, 0.6081206, 0.5357612,
0.3725430, 0.4128226, 0.4136910, 0.4335321, 0.3977218, 0.2014870, 0.1523116, 0.1144855,
0.2669177, 0.3802839, 0.4378792, 0.4317189, 0.4107030, 0.3924865, 0.3880213, 0.4167096,
0.4560049, 0.3031286, 0.1714054, 0.1247945, 0.2792253, 0.5250513, 0.5009453, 0.4164559,
0.5648495, 0.5612940, 0.5789329, 0.6259627, 0.6313506, 0.2998934, 0.1830370, 0.1138036,
0.2726309, 0.7146528, 0.7470205, 0.6823039, 0.4200453, 0.4184876, 0.4247872, 0.4072863,
0.3896646, 0.2117631, 0.1440002, 0.1184743, 0.2998843, 0.5001649, 0.4489868, 0.4334888,
0.4956870, 0.4937018, 0.4915547, 0.4522707, 0.4844724, 0.1836997, 0.1662375, 0.1305716,
0.3006867, 0.4150780, 0.4227252, 0.4792481, 0.3331140, 0.3932817, 0.3908054, 0.4302371,
0.4313541, 0.3172742, 0.2165744, 0.1215594, 0.3154495, 0.5483247, 0.4049449, 0.3878837,
0.3546896, 0.3471439, 0.3604075, 0.3737522, 0.3935587, 0.1885429, 0.1262874, 0.1060934,
0.2908784, 0.4411755, 0.4328711, 0.3614588, 0.4707795, 0.5196195, 0.5355426, 0.5618424,
0.6487202, 0.2454761, 0.1734311, 0.1289636, 0.3379610, 0.5471798, 0.6262681, 0.5661489,
0.4256305, 0.3829019, 0.4147631, 0.3883832, 0.4421881, 0.2569741, 0.1679453, 0.1229857,
0.3161612, 0.5718548, 0.5022845, 0.4384320, 0.4833015, 0.5607354, 0.5911417, 0.6054455,
0.7407989, 0.2641570, 0.2223883, 0.1732638, 0.3713129, 0.6334904, 0.5056662, 0.5086384,
0.6404461, 0.6607163, 0.6975814, 0.6988414, 0.6305668, 0.3957922, 0.2405463, 0.1702442,
0.3376863, 0.7107646, 0.7796035, 0.7617256, 0.4520820, 0.4944075, 0.5191625, 0.5101102,
0.5340845, 0.2766269, 0.1937628, 0.1268151, 0.3297246, 0.4996152, 0.5680733, 0.5432439,
0.2934594, 0.3703059, 0.3770584, 0.3927496, 0.4186471, 0.3070363, 0.1935445, 0.1617593,
0.3806264, 0.5547792, 0.4303426, 0.3757589, 0.3235541, 0.3807562, 0.4074907, 0.4410590,
0.3639065, 0.1929606, 0.1630003, 0.1254303, 0.2769457, 0.4091473, 0.3765123, 0.4112064,
0.5593316, 0.4927259, 0.4800007, 0.4951635, 0.5285066, 0.2988661, 0.1751273, 0.1234178,
0.2486431, 0.5335178, 0.5425130, 0.5194400, 0.4192159, 0.4058726, 0.4016810, 0.3883046,
0.3893425, 0.2407871, 0.2353592, 0.1430258, 0.3039290, 0.5868432, 0.4014464, 0.4360287,
0.3771663, 0.3833609, 0.4079855, 0.4237471, 0.4469152, 0.2603809, 0.1841387, 0.1234232,
0.3003540, 0.4751062, 0.4112190, 0.4057422, 0.4006226, 0.4192532, 0.4043015, 0.4060271,
0.5001752, 0.2138697, 0.1689400, 0.1239164, 0.2849761, 0.4967849, 0.5237180, 0.4421997,
0.4230981, 0.4622701, 0.5198418, 0.5458606, 0.5664571, 0.3457476, 0.2646740, 0.1562492,
0.2966123, 0.6236604, 0.5298467, 0.4825815, 0.3736711, 0.4552511, 0.4352888, 0.4536387,
0.4341553, 0.1830541, 0.2142530, 0.1329380, 0.3255760, 0.4228806, 0.5552044, 0.4959562,
0.4361565, 0.4515786, 0.4882130, 0.5782329, 0.6139658, 0.1955324, 0.1874049, 0.1226886,
0.2914157, 0.4839833, 0.4694495, 0.4963178, 0.3421591, 0.3663441, 0.3610790, 0.3645548,
0.5018332, 0.2014336, 0.1545987, 0.1210608, 0.2689403, 0.4357934, 0.4612185, 0.3953088,
0.3720816, 0.3936739, 0.4118911, 0.4292425, 0.4592688, 0.2635355, 0.1936843, 0.1405593,
0.3424603, 0.5105915, 0.4270623, 0.3653797, 0.5325907, 0.5396860, 0.5280182, 0.5863939,
0.6343227, 0.4893963, 0.2769384, 0.2033194, 0.3667455, 0.7233313, 0.7342692, 0.6242543,
0.5113235, 0.5147388, 0.5078914, 0.5385845, 0.5922222, 0.3765999, 0.1959137, 0.1328820,
0.2953484, 0.4279686, 0.5234980, 0.4990419, 0.4732890, 0.4752097, 0.4905265, 0.5111100,
0.5429206, 0.3147995, 0.2884359, 0.1594588, 0.3677719, 0.6130381, 0.4750612, 0.5093564,
0.4508599, 0.4517384, 0.4632085, 0.5279158, 0.5650056, 0.3072738, 0.2217276, 0.1412470,
0.3368340, 0.6823735, 0.5597975, 0.4909233, 0.3116770, 0.3476133, 0.3601935, 0.3923293,
0.4269024, 0.2169689, 0.1678552, 0.2380705, 0.3050141, 0.3195854, 0.3543210, 0.3457924,
0.5544310, 0.5930807, 0.5697071, 0.5689750, 0.4934248, 0.2493468, 0.1959762, 0.1549121,
0.2625672, 0.3814519, 0.4619138, 0.5176329, 0.3525565, 0.3727013, 0.4109826, 0.4385986,
0.4813475, 0.2896069, 0.2371415, 0.1632924, 0.3290820, 0.5921227, 0.5224040, 0.4040603,
0.5254754, 0.4973365, 0.4925237, 0.4841734, 0.4558772, 0.1999226, 0.1676770, 0.1282206,
0.2952700, 0.5140321, 0.4743685, 0.5072102, 0.3769370, 0.3586397, 0.3568911, 0.3588541,
0.3451502, 0.2661180, 0.1774582, 0.1313297, 0.3431143, 0.5393540, 0.3427220, 0.3940676,
0.3966500, 0.4432463, 0.4498671, 0.4494286, 0.4731898, 0.2030497, 0.1590509, 0.1273881,
0.3133036, 0.4445470, 0.4723454, 0.4231781, 0.4492026, 0.4201385, 0.4323172, 0.4570506,
0.4724575, 0.3067750, 0.1566609, 0.1379041, 0.2426820, 0.4058133, 0.5707770, 0.4963087,
0.4485372, 0.4795719, 0.5038071, 0.5706937, 0.5693064, 0.4066596, 0.3255471, 0.1795659,
0.3876123, 0.6680026, 0.5797325, 0.5111840, 0.5088494, 0.4964045, 0.4934354, 0.5045712,
0.5035116, 0.3171720, 0.1861163, 0.1375177, 0.2863346, 0.4626628, 0.5478700, 0.5534115), 12, K)
# beta_true <- beta_true[,1:40]
Sig_true <- matrix(c(1.054582e-02,  0.0036552449,  0.0034287570, 0.0037819281, 0.0052769473,  0.0033479305,  1.735606e-03, 0.0013311390,  0.0007303181, 9.934102e-04,  0.0002924187,  8.178611e-05,
3.655245e-03,  0.0040300917,  0.0034829780, 0.0042125360, 0.0051616871,  0.0011291037, -5.907785e-04, 0.0006363078,  0.0019636813, 2.372327e-04, -0.0003020643, -5.309682e-04,
3.428757e-03,  0.0034829780,  0.0057563821, 0.0061174733, 0.0076340901,  0.0027076594, -3.161491e-04, 0.0005256572,  0.0027309274, 2.809536e-03,  0.0006780922,  5.353495e-04,
3.781928e-03,  0.0042125360,  0.0061174733, 0.0114369963, 0.0123136426,  0.0039353254,  5.054767e-04, 0.0007249143,  0.0010724356, 2.060226e-03,  0.0004990777,  4.483083e-04,
5.276947e-03,  0.0051616871,  0.0076340901, 0.0123136426, 0.0279586638,  0.0087260330,  3.779015e-03, 0.0023671937,  0.0026745378, 4.462126e-03,  0.0013934682,  8.463755e-04,
3.347930e-03,  0.0011291037,  0.0027076594, 0.0039353254, 0.0087260330,  0.0562979613,  1.601453e-02, 0.0022241951, -0.0014553442, 5.652704e-04,  0.0005428444,  6.926266e-04,
1.735606e-03, -0.0005907785, -0.0003161491, 0.0005054767, 0.0037790151,  0.0160145283,  3.159202e-02, 0.0116718495, -0.0043863350, 8.580534e-05,  0.0010047893,  1.605082e-03,
1.331139e-03,  0.0006363078,  0.0005256572, 0.0007249143, 0.0023671937,  0.0022241951,  1.167185e-02, 0.0102543053,  0.0028898668, 2.465628e-03,  0.0013439284,  5.970494e-04,
7.303181e-04,  0.0019636813,  0.0027309274, 0.0010724356, 0.0026745378, -0.0014553442, -4.386335e-03, 0.0028898668,  0.0272251753, 1.391802e-02,  0.0046732594, -2.050377e-04,
9.934102e-04,  0.0002372327,  0.0028095359, 0.0020602255, 0.0044621260,  0.0005652704,  8.580534e-05, 0.0024656275,  0.0139180218, 7.227951e-02,  0.0287539844,  1.396291e-02,
2.924187e-04, -0.0003020643,  0.0006780922, 0.0004990777, 0.0013934682,  0.0005428444,  1.004789e-03, 0.0013439284,  0.0046732594, 2.875398e-02,  0.0285336845,  1.304293e-02,
8.178611e-05, -0.0005309682,  0.0005353495, 0.0004483083, 0.0008463755,  0.0006926266,  1.605082e-03, 0.0005970494, -0.0002050377, 1.396291e-02,  0.0130429290,  1.178796e-02), 12, 12)

# sigma2_true <- rep(1.5, 12)
# R_true <- diag(12)
# for (i in 1:11) {
#   for (j in (i+1):12) {
#       R_true[i,j] <- R_true[j,i] <- 0.8^(abs(i-j))
#   }
# }
# Sig_true <- diag(sqrt(sigma2_true)) %*% R_true %*% diag(sqrt(sigma2_true))
Sig_true_chol <- chol(Sig_true)
# nyear <- 3
nyear.grid <- c(3, 5, 10, 15)
alpha.grid <- c(0.01, 0.025, 0.05)
percentage_increment <- 1.2
df_size <- lapply(1:nsim, function(isim) {
    lapply(nyear.grid, function(nyear) {
        y <- array(0, dim = c(12, K, nyear))
        for (iyear in 1:nyear) {
             y[,,iyear] <- crossprod(Sig_true_chol, matrix(rnorm(12*K), 12, K)) + beta_true
        }
        y_Kp1 <-crossprod(Sig_true_chol, matrix(rnorm(12*K), 12, K)) + beta_true
        list(y = y, y_Kp1 = y_Kp1)
    })
})
save(df_size, file = "multipleAccount_nsim_10000_1p2_Talpha_v3.RData", version = 2)


####################
# Data generation  #
# (Power Analysis) #
####################
set.seed(2797542)
K <- 70
nsim <- 1000
beta_true <- matrix(c(0.1275723, 0.2171228, 0.3081110, 0.3511947, 0.7959736, 0.4038531, 0.4795192, 0.2260417,
1.3584910, 2.3825286, 1.0019399, 0.4052773, 0.5444945, 0.5236327, 0.5309396, 0.5486614,
0.5623856, 0.3765636, 0.2266925, 0.1756061, 0.3290557, 0.5376993, 0.5953601, 0.5525292,
0.3357988, 0.3952969, 0.4207817, 0.4348561, 0.4110409, 0.1835819, 0.1883897, 0.1296391,
0.3508947, 0.6147458, 0.4909258, 0.4128457, 0.4515024, 0.4132818, 0.4543722, 0.4986570,
0.5301654, 0.2680528, 0.2519400, 0.1456691, 0.3242887, 0.5284132, 0.4504773, 0.4767986,
0.3997492, 0.4771224, 0.4647772, 0.4726600, 0.4750175, 0.3284144, 0.3066620, 0.1519053,
0.2802797, 0.5036309, 0.5822183, 0.5149771, 0.3734794, 0.3948873, 0.4032494, 0.4100586,
0.4468242, 0.3222923, 0.2761854, 0.1615315, 0.2563319, 0.3772574, 0.4710287, 0.4229677,
0.5113622, 0.5536044, 0.5690038, 0.5317177, 0.5211124, 0.3035806, 0.2460477, 0.1647474,
0.3822736, 0.7932413, 0.5747804, 0.4934105, 0.4356089, 0.4714201, 0.5025385, 0.5424768,
0.5164568, 0.2821819, 0.2691165, 0.1674050, 0.3336717, 0.4937105, 0.5724915, 0.5419586,
0.3284741, 0.3489108, 0.4067004, 0.4288516, 0.4418429, 0.2710459, 0.1857509, 0.1125911,
0.2357910, 0.4080935, 0.3429750, 0.3315491, 0.4981028, 0.5216440, 0.5371516, 0.5714386,
0.5855195, 0.2975419, 0.3209480, 0.1844910, 0.3644227, 0.5707449, 0.6458457, 0.5532275,
0.4702482, 0.4405116, 0.4243047, 0.4706976, 0.4678369, 0.2386029, 0.1862869, 0.1308019,
0.3025070, 0.3494058, 0.4118278, 0.4623836, 0.3081094, 0.3732077, 0.3761074, 0.3706099,
0.3998539, 0.2552004, 0.2709500, 0.1817386, 0.2890607, 0.4550335, 0.4212473, 0.3677032,
0.3789227, 0.4096517, 0.4355518, 0.4409613, 0.4871740, 0.6400537, 0.3116382, 0.1779999,
0.3501122, 0.4719613, 0.3859132, 0.4214637, 0.4358486, 0.3962583, 0.4003125, 0.4391502,
0.5179681, 0.4936818, 0.2055493, 0.1351303, 0.2836813, 0.4292052, 0.4399500, 0.4683949,
0.4417972, 0.4205337, 0.4182235, 0.4422414, 0.5482904, 0.2342961, 0.2063070, 0.1437981,
0.3012337, 0.4449266, 0.3949865, 0.4174462, 0.4658631, 0.4756963, 0.5122125, 0.5618358,
0.5428506, 0.3997647, 0.3656613, 0.1756530, 0.3295819, 0.6965748, 0.5991151, 0.5033596,
0.5463636, 0.5232757, 0.5245752, 0.5595121, 0.5515097, 0.3108743, 0.2602779, 0.1569271,
0.2683762, 0.6010637, 0.5937545, 0.5448436, 0.5566080, 0.5404081, 0.5286979, 0.5132365,
0.5547322, 0.3187384, 0.1669004, 0.1265456, 0.3483649, 0.5721666, 0.5381855, 0.5880174,
0.5099147, 0.5316583, 0.5230508, 0.5365181, 0.5378713, 0.3925432, 0.2912928, 0.1671957,
0.3228216, 0.5209287, 0.5646782, 0.5488027, 0.3460908, 0.3664352, 0.3565424, 0.3967138,
0.4362319, 0.3720437, 0.2322005, 0.1547735, 0.3018471, 0.5537609, 0.4183475, 0.4257506,
0.3927374, 0.4110849, 0.4299553, 0.4630775, 0.5888526, 0.3187948, 0.3068038, 0.1812327,
0.3636568, 0.5833732, 0.5050208, 0.4633725, 0.3986953, 0.4210301, 0.4122330, 0.4304064,
0.4385551, 0.2772909, 0.3709811, 0.1771347, 0.3301942, 0.5403029, 0.5118093, 0.3937438,
0.4296906, 0.4212315, 0.4460896, 0.4450868, 0.4473610, 0.2419635, 0.2305823, 0.1491931,
0.2913239, 0.4081383, 0.4716768, 0.4646975, 0.4118083, 0.3757133, 0.3804427, 0.4171646,
0.4436916, 0.3368843, 0.1848066, 0.1428415, 0.2906296, 0.5067905, 0.4198099, 0.4012672,
0.3909191, 0.3753936, 0.3996358, 0.3965559, 0.4558737, 0.3331946, 0.2737851, 0.1804058,
0.3114853, 0.7225091, 0.5410612, 0.3777433, 0.3638129, 0.3654462, 0.3772129, 0.3806440,
0.3529674, 0.2183122, 0.1523978, 0.1206746, 0.2602506, 0.3388680, 0.3753706, 0.3726719,
0.5451569, 0.5379713, 0.5862367, 0.6165266, 0.6169164, 0.6343816, 0.2571071, 0.1410201,
0.3069147, 0.5191181, 0.5550714, 0.5290042, 0.4034582, 0.4669141, 0.4833851, 0.4904637,
0.4739323, 0.3427771, 0.2624738, 0.1466243, 0.3182946, 0.4251999, 0.6093804, 0.5459347,
0.4482511, 0.4999577, 0.5166653, 0.4985260, 0.4433156, 0.5695036, 0.2986641, 0.1652782,
0.2679887, 0.5435838, 0.5174679, 0.4978418, 0.3041193, 0.3488134, 0.3634898, 0.3872111,
0.3169256, 0.2600349, 0.2390257, 0.1697706, 0.2774305, 0.3514142, 0.4138466, 0.3989645,
0.5440294, 0.5460139, 0.5366055, 0.5364159, 0.4841379, 0.2922079, 0.2857683, 0.1509488,
0.3060899, 0.4291707, 0.5251736, 0.5792246, 0.3582144, 0.4472419, 0.4679336, 0.4959834,
0.4788454, 0.1562478, 0.4049201, 0.3146375, 0.3291046, 0.5487720, 0.5677986, 0.5341627,
0.4839384, 0.4882545, 0.4866299, 0.4784891, 0.4715546, 0.2558165, 0.1426956, 0.1103919,
0.2440325, 0.5374797, 0.5612712, 0.4971420, 0.4710010, 0.5039502, 0.5230138, 0.5117551,
0.6076788, 0.2395489, 0.1457969, 0.1112086, 0.2662448, 0.5002825, 0.6081206, 0.5357612,
0.3725430, 0.4128226, 0.4136910, 0.4335321, 0.3977218, 0.2014870, 0.1523116, 0.1144855,
0.2669177, 0.3802839, 0.4378792, 0.4317189, 0.4107030, 0.3924865, 0.3880213, 0.4167096,
0.4560049, 0.3031286, 0.1714054, 0.1247945, 0.2792253, 0.5250513, 0.5009453, 0.4164559,
0.5648495, 0.5612940, 0.5789329, 0.6259627, 0.6313506, 0.2998934, 0.1830370, 0.1138036,
0.2726309, 0.7146528, 0.7470205, 0.6823039, 0.4200453, 0.4184876, 0.4247872, 0.4072863,
0.3896646, 0.2117631, 0.1440002, 0.1184743, 0.2998843, 0.5001649, 0.4489868, 0.4334888,
0.4956870, 0.4937018, 0.4915547, 0.4522707, 0.4844724, 0.1836997, 0.1662375, 0.1305716,
0.3006867, 0.4150780, 0.4227252, 0.4792481, 0.3331140, 0.3932817, 0.3908054, 0.4302371,
0.4313541, 0.3172742, 0.2165744, 0.1215594, 0.3154495, 0.5483247, 0.4049449, 0.3878837,
0.3546896, 0.3471439, 0.3604075, 0.3737522, 0.3935587, 0.1885429, 0.1262874, 0.1060934,
0.2908784, 0.4411755, 0.4328711, 0.3614588, 0.4707795, 0.5196195, 0.5355426, 0.5618424,
0.6487202, 0.2454761, 0.1734311, 0.1289636, 0.3379610, 0.5471798, 0.6262681, 0.5661489,
0.4256305, 0.3829019, 0.4147631, 0.3883832, 0.4421881, 0.2569741, 0.1679453, 0.1229857,
0.3161612, 0.5718548, 0.5022845, 0.4384320, 0.4833015, 0.5607354, 0.5911417, 0.6054455,
0.7407989, 0.2641570, 0.2223883, 0.1732638, 0.3713129, 0.6334904, 0.5056662, 0.5086384,
0.6404461, 0.6607163, 0.6975814, 0.6988414, 0.6305668, 0.3957922, 0.2405463, 0.1702442,
0.3376863, 0.7107646, 0.7796035, 0.7617256, 0.4520820, 0.4944075, 0.5191625, 0.5101102,
0.5340845, 0.2766269, 0.1937628, 0.1268151, 0.3297246, 0.4996152, 0.5680733, 0.5432439,
0.2934594, 0.3703059, 0.3770584, 0.3927496, 0.4186471, 0.3070363, 0.1935445, 0.1617593,
0.3806264, 0.5547792, 0.4303426, 0.3757589, 0.3235541, 0.3807562, 0.4074907, 0.4410590,
0.3639065, 0.1929606, 0.1630003, 0.1254303, 0.2769457, 0.4091473, 0.3765123, 0.4112064,
0.5593316, 0.4927259, 0.4800007, 0.4951635, 0.5285066, 0.2988661, 0.1751273, 0.1234178,
0.2486431, 0.5335178, 0.5425130, 0.5194400, 0.4192159, 0.4058726, 0.4016810, 0.3883046,
0.3893425, 0.2407871, 0.2353592, 0.1430258, 0.3039290, 0.5868432, 0.4014464, 0.4360287,
0.3771663, 0.3833609, 0.4079855, 0.4237471, 0.4469152, 0.2603809, 0.1841387, 0.1234232,
0.3003540, 0.4751062, 0.4112190, 0.4057422, 0.4006226, 0.4192532, 0.4043015, 0.4060271,
0.5001752, 0.2138697, 0.1689400, 0.1239164, 0.2849761, 0.4967849, 0.5237180, 0.4421997,
0.4230981, 0.4622701, 0.5198418, 0.5458606, 0.5664571, 0.3457476, 0.2646740, 0.1562492,
0.2966123, 0.6236604, 0.5298467, 0.4825815, 0.3736711, 0.4552511, 0.4352888, 0.4536387,
0.4341553, 0.1830541, 0.2142530, 0.1329380, 0.3255760, 0.4228806, 0.5552044, 0.4959562,
0.4361565, 0.4515786, 0.4882130, 0.5782329, 0.6139658, 0.1955324, 0.1874049, 0.1226886,
0.2914157, 0.4839833, 0.4694495, 0.4963178, 0.3421591, 0.3663441, 0.3610790, 0.3645548,
0.5018332, 0.2014336, 0.1545987, 0.1210608, 0.2689403, 0.4357934, 0.4612185, 0.3953088,
0.3720816, 0.3936739, 0.4118911, 0.4292425, 0.4592688, 0.2635355, 0.1936843, 0.1405593,
0.3424603, 0.5105915, 0.4270623, 0.3653797, 0.5325907, 0.5396860, 0.5280182, 0.5863939,
0.6343227, 0.4893963, 0.2769384, 0.2033194, 0.3667455, 0.7233313, 0.7342692, 0.6242543,
0.5113235, 0.5147388, 0.5078914, 0.5385845, 0.5922222, 0.3765999, 0.1959137, 0.1328820,
0.2953484, 0.4279686, 0.5234980, 0.4990419, 0.4732890, 0.4752097, 0.4905265, 0.5111100,
0.5429206, 0.3147995, 0.2884359, 0.1594588, 0.3677719, 0.6130381, 0.4750612, 0.5093564,
0.4508599, 0.4517384, 0.4632085, 0.5279158, 0.5650056, 0.3072738, 0.2217276, 0.1412470,
0.3368340, 0.6823735, 0.5597975, 0.4909233, 0.3116770, 0.3476133, 0.3601935, 0.3923293,
0.4269024, 0.2169689, 0.1678552, 0.2380705, 0.3050141, 0.3195854, 0.3543210, 0.3457924,
0.5544310, 0.5930807, 0.5697071, 0.5689750, 0.4934248, 0.2493468, 0.1959762, 0.1549121,
0.2625672, 0.3814519, 0.4619138, 0.5176329, 0.3525565, 0.3727013, 0.4109826, 0.4385986,
0.4813475, 0.2896069, 0.2371415, 0.1632924, 0.3290820, 0.5921227, 0.5224040, 0.4040603,
0.5254754, 0.4973365, 0.4925237, 0.4841734, 0.4558772, 0.1999226, 0.1676770, 0.1282206,
0.2952700, 0.5140321, 0.4743685, 0.5072102, 0.3769370, 0.3586397, 0.3568911, 0.3588541,
0.3451502, 0.2661180, 0.1774582, 0.1313297, 0.3431143, 0.5393540, 0.3427220, 0.3940676,
0.3966500, 0.4432463, 0.4498671, 0.4494286, 0.4731898, 0.2030497, 0.1590509, 0.1273881,
0.3133036, 0.4445470, 0.4723454, 0.4231781, 0.4492026, 0.4201385, 0.4323172, 0.4570506,
0.4724575, 0.3067750, 0.1566609, 0.1379041, 0.2426820, 0.4058133, 0.5707770, 0.4963087,
0.4485372, 0.4795719, 0.5038071, 0.5706937, 0.5693064, 0.4066596, 0.3255471, 0.1795659,
0.3876123, 0.6680026, 0.5797325, 0.5111840, 0.5088494, 0.4964045, 0.4934354, 0.5045712,
0.5035116, 0.3171720, 0.1861163, 0.1375177, 0.2863346, 0.4626628, 0.5478700, 0.5534115), 12, K)

Sig_true <- matrix(c(1.054582e-02,  0.0036552449,  0.0034287570, 0.0037819281, 0.0052769473,  0.0033479305,  1.735606e-03, 0.0013311390,  0.0007303181, 9.934102e-04,  0.0002924187,  8.178611e-05,
3.655245e-03,  0.0040300917,  0.0034829780, 0.0042125360, 0.0051616871,  0.0011291037, -5.907785e-04, 0.0006363078,  0.0019636813, 2.372327e-04, -0.0003020643, -5.309682e-04,
3.428757e-03,  0.0034829780,  0.0057563821, 0.0061174733, 0.0076340901,  0.0027076594, -3.161491e-04, 0.0005256572,  0.0027309274, 2.809536e-03,  0.0006780922,  5.353495e-04,
3.781928e-03,  0.0042125360,  0.0061174733, 0.0114369963, 0.0123136426,  0.0039353254,  5.054767e-04, 0.0007249143,  0.0010724356, 2.060226e-03,  0.0004990777,  4.483083e-04,
5.276947e-03,  0.0051616871,  0.0076340901, 0.0123136426, 0.0279586638,  0.0087260330,  3.779015e-03, 0.0023671937,  0.0026745378, 4.462126e-03,  0.0013934682,  8.463755e-04,
3.347930e-03,  0.0011291037,  0.0027076594, 0.0039353254, 0.0087260330,  0.0562979613,  1.601453e-02, 0.0022241951, -0.0014553442, 5.652704e-04,  0.0005428444,  6.926266e-04,
1.735606e-03, -0.0005907785, -0.0003161491, 0.0005054767, 0.0037790151,  0.0160145283,  3.159202e-02, 0.0116718495, -0.0043863350, 8.580534e-05,  0.0010047893,  1.605082e-03,
1.331139e-03,  0.0006363078,  0.0005256572, 0.0007249143, 0.0023671937,  0.0022241951,  1.167185e-02, 0.0102543053,  0.0028898668, 2.465628e-03,  0.0013439284,  5.970494e-04,
7.303181e-04,  0.0019636813,  0.0027309274, 0.0010724356, 0.0026745378, -0.0014553442, -4.386335e-03, 0.0028898668,  0.0272251753, 1.391802e-02,  0.0046732594, -2.050377e-04,
9.934102e-04,  0.0002372327,  0.0028095359, 0.0020602255, 0.0044621260,  0.0005652704,  8.580534e-05, 0.0024656275,  0.0139180218, 7.227951e-02,  0.0287539844,  1.396291e-02,
2.924187e-04, -0.0003020643,  0.0006780922, 0.0004990777, 0.0013934682,  0.0005428444,  1.004789e-03, 0.0013439284,  0.0046732594, 2.875398e-02,  0.0285336845,  1.304293e-02,
8.178611e-05, -0.0005309682,  0.0005353495, 0.0004483083, 0.0008463755,  0.0006926266,  1.605082e-03, 0.0005970494, -0.0002050377, 1.396291e-02,  0.0130429290,  1.178796e-02), 12, 12)

percentage_increment <- 1.2
beta_true_alt <- beta_true
beta_true_alt[,10:12] <- beta_true_alt[,10:12] * percentage_increment
Sig_true_chol <- chol(Sig_true)
Siginv_true <- chol2inv(Sig_true_chol)
# nyear <- 3
nyear.grid <- c(3, 5, 10, 15)
alpha.grid <- c(0.025, 0.05, 0.1)
df_power <- lapply(1:nsim, function(isim) {
    lapply(nyear.grid, function(nyear) {
        y <- array(0, dim = c(12, K, nyear))
        for (iyear in 1:nyear) {
             y[,,iyear] <- crossprod(Sig_true_chol, matrix(rnorm(12*K), 12, K)) + beta_true
        }
        y_Kp1 <-crossprod(Sig_true_chol, matrix(rnorm(12*K), 12, K)) + beta_true_alt
        list(y = y, y_Kp1 = y_Kp1)
    })
})
save(df_power, file = "multipleAccount_nsim_1000_1p2_Tpower_v3.RData", version = 2)
